<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trivia – Court Kings HQ</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    :root{
      --primary:#00ffc6; --accent:#c084fc; --bg-dark:#0c0c0c; --card-bg:#151515; --border:#1e1e1e; --muted:#9aa3ab;
      --divider: rgba(255,255,255,.08); --gold:#ffc107;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Outfit',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg-dark); color:#fff; display:flex; flex-direction:column; overflow-x:hidden;
    }

    /* Header / Nav (identical behavior to index.html) */
    header{
      display:grid;grid-template-columns:auto 1fr;align-items:center;gap:1rem;
      padding:1rem 1.25rem;background:#121212;border-bottom:1px solid #1f1f1f;position:relative;
    }
    .logo-container img{
      height:64px;width:auto;border-radius:12px;box-shadow:0 0 8px rgba(0,0,0,.4);transition:transform .25s ease
    }
    .logo-container img:hover{transform:scale(1.04)}

    /* Desktop nav */
    nav.main-nav{display:flex;justify-content:flex-end;align-items:center;flex-wrap:wrap;gap:.9rem 1.2rem}
    nav.main-nav a{color:#ccc;text-decoration:none;font-weight:600;padding:.4rem .2rem;transition:color .2s ease;white-space:nowrap}
    nav.main-nav a:hover{color:var(--primary)}
    .support-desktop{color:var(--gold)!important}

    /* Mobile hamburger */
    .nav-toggle{
      display:none;background:transparent;border:1px solid #242424;color:#eaeaea;
      font-weight:800;border-radius:10px;padding:.45rem .7rem;line-height:1;
    }
    .nav-toggle:focus{outline:2px solid rgba(0,255,198,.4); outline-offset:2px}

    /* Page layout */
    .main{
      flex:1;display:flex;justify-content:center;align-items:center;
      padding:3rem 1.25rem;text-align:center
    }
    .container{
      background:#1a1a1a;border:1px solid rgba(255,255,255,.1);
      border-radius:16px; padding:2rem; max-width:640px; width:100%;
      box-shadow:0 0 20px rgba(255,255,255,.05);
    }

    input,button{
      background-color:#262626;color:#fff;border:1px solid #333;
      padding:.75rem 1rem;margin:.5rem 0;border-radius:8px;cursor:pointer;font-size:1rem
    }
    button:hover{background:#333}

    .feedback{margin-top:1rem;font-weight:700}
    .score-text{font-size:1.3rem;margin-bottom:2rem}

    .leaderboard-container{
      background:#141414;border:1px solid rgba(255,255,255,.08);
      border-radius:16px;padding:1.5rem;margin-top:2rem;box-shadow:0 0 10px rgba(255,255,255,.05);text-align:left
    }
    .leaderboard-container h3{
      margin-bottom:1rem;font-size:1.2rem;color:#f2f2f2;border-bottom:1px solid #333;padding-bottom:.5rem
    }
    .leaderboard-entry{
      display:flex;justify-content:space-between;align-items:center;background:#1e1e1e;
      padding:.75rem 1rem;border-radius:8px;margin-bottom:.5rem;transition:background .2s
    }
    .leaderboard-entry:hover{background:#2a2a2a}
    .leaderboard-entry span{font-size:1rem;color:#f2f2f2}

    footer{ text-align:center; padding:1.5rem; font-size:.9rem; color:#777; }

    /* Responsive (same breakpoints/behavior as index.html) */
    @media (max-width:780px){
      header{grid-template-columns:1fr auto}
      .nav-toggle{display:inline-block}
      nav.main-nav{
        display:none;position:absolute;top:100%;right:0;left:0;background:#101214;border-top:1px solid #202327;
        padding:.6rem 1rem;gap:.4rem;z-index:5;flex-direction:column;align-items:flex-start
      }
      nav.main-nav.open{display:flex}
      nav.main-nav a{padding:.6rem 0;width:100%}

      .main{padding:2rem 1rem}
      .container{padding:1.5rem 1rem}
    }
    @media (max-width:480px){
      .container{padding:1.25rem .9rem}
      input,button{font-size:.95rem}
    }
  </style>
</head>
<body>

  <!-- Header copied from index.html structure -->
  <header>
    <div class="logo-container">
      <a href="index.html"><img src="img/logo6.png" alt="Court Kings HQ Logo"></a>
    </div>

    <!-- Mobile hamburger -->
    <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Toggle menu">☰</button>

    <nav id="primary-nav" class="main-nav" aria-label="Primary navigation">
      <a href="about.html">About</a>
      <a href="archive.html">Live Hub</a>
      <a href="trivia.html">Trivia</a>
      <a href="offseason.html">Offseason</a>
      <a href="betting.html">Crown Picks</a>
      <a href="contact.html">Contact</a>
      <a class="support-desktop" href="https://buymeacoffee.com/courtkingshq" target="_blank" rel="noopener">☕ Support</a>
    </nav>
  </header>

  <div class="main">
    <div class="container" id="app"></div>
  </div>

  <footer>© 2025 Court Kings HQ – All stats auto-tracked &amp; published. @CourtKingsHQ</footer>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <script>
  // --- Supabase client ---
  const supabase = window.supabase.createClient(
    'https://fjtxowbjnxclzcogostk.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZqdHhvd2JqbnhjbHpjb2dvc3RrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2MDE5NTgsImV4cCI6MjA1ODE3Nzk1OH0.LPkFw-UX6io0F3j18Eefd1LmeAGGXnxL4VcCLOR_c1Q'
  );

  // --- Trivia data / app state (unchanged) ---
  const triviaQuestions = [
    { question: "Who is the only player in NBA history with a 20-assist triple-double in a playoff game?", answer: "Magic Johnson" },
    { question: "Which player recorded the only 30-point, 10-block game in the playoffs since 2000?", answer: "Dwight Howard" },
    { question: "Who is the youngest player to record a triple-double in NBA playoff history?", answer: "Magic Johnson" },
    { question: "Which player had the most steals in a single NBA playoff game?", answer: "Allen Iverson" },
    { question: "Who was the last player to average at least 35 PPG in a single postseason (min 10 games)?", answer: "Luka Doncic" },
    { question: "Which player recorded a 45-point game while shooting 70 percent+ in a playoff loss?", answer: "Giannis Antetokounmpo" },
    { question: "Who is the only player with a 40-point game off the bench in NBA playoff history?", answer: "Nick Van Exel" },
    { question: "Which player has the most playoff games with 5+ steals since 2000?", answer: "Dwyane Wade" },
    { question: "Who recorded the most blocks in a single NBA Finals game?", answer: "Dwight Howard" },
    { question: "Which player had a 25-rebound game in the 2023 NBA Playoffs?", answer: "Kevon Looney" },
    { question: "Which player recorded back-to-back 40-point games in the 2022 NBA Playoffs?", answer: "Luka Doncic" },
    { question: "Who is the only player with a triple-double in their NBA Finals debut?", answer: "Jason Kidd" },
    { question: "Who scored the most points in their first ever NBA playoff game?", answer: "John Williamson" },
    { question: "Which player has the most career playoff games with 30+ points and 10+ assists?", answer: "LeBron James" },
    { question: "Who is the only player with a playoff game of 25+ points, 15+ assists, and 0 turnovers?", answer: "Chris Paul" },
    { question: "Which player is the only center with 15+ assists in a modern era playoff game?", answer: "Nikola Jokic" },
    { question: "Who holds the record for most three-pointers made in a single NBA Finals game?", answer: "Stephen Curry" },
    { question: "Who is the oldest player to record a triple-double in a playoff game?", answer: "LeBron James" },
    { question: "Which player had the most 40+ point games in a single postseason?", answer: "Michael Jordan" },
    { question: "Which player recorded a 30-10-10 playoff triple-double while hitting 7+ threes?", answer: "James Harden" },
    { question: "Who is the only player to record 60 points in an NBA playoff game since 2000?", answer: "Donovan Mitchell" },
    { question: "Which player has the most career triple-doubles in NBA playoff history?", answer: "Magic Johnson" },
    { question: "Who holds the record for most rebounds in a single NBA playoff game?", answer: "Wilt Chamberlain" },
    { question: "Which player has the most career blocks in NBA playoff history?", answer: "Tim Duncan" },
    { question: "Who is the youngest player to score 50 points in an NBA playoff game?", answer: "Rick Barry" },
    { question: "Which player made the most three-pointers in a single NBA playoff game?", answer: "Damian Lillard" },
    { question: "Who is the only player with a 50-point, 10-assist game in NBA playoff history?", answer: "Jamal Murray" },
    { question: "Who recorded the most assists in a single NBA playoff game?", answer: "Magic Johnson" },
    { question: "Which player had a 20-rebound, 20-assist game in the NBA playoffs?", answer: "Wilt Chamberlain" },
    { question: "Who has the most career playoff points in NBA history?", answer: "LeBron James" },
    { question: "Who was the last player to record a 5x5 stat line in an NBA playoff game?", answer: "Draymond Green" },
    { question: "Which player recorded the most minutes played in a single NBA playoff game?", answer: "Wilt Chamberlain" },
    { question: "Which player had the most steals in a single NBA Finals game?", answer: "Isiah Thomas" },
    { question: "Who is the only rookie to average a triple-double in a playoff series?", answer: "Magic Johnson" },
    { question: "Which player holds the record for most free throws made in a single playoff game?", answer: "Bob Cousy" },
    { question: "Who is the only player with a 20-rebound triple-double in the NBA Finals?", answer: "Bill Russell" },
    { question: "Who has the most career playoff wins in NBA history?", answer: "LeBron James" },
    { question: "Which player recorded back-to-back 50-point games in the NBA playoffs?", answer: "Allen Iverson" },
    { question: "Who recorded the most turnovers in a single NBA playoff game?", answer: "James Harden" },
    { question: "Who is the only player to average 40+ points per game in an NBA Finals series?", answer: "Michael Jordan" }
  ];

  let username = "", score = 0, currentIndex = 0, selectedQuestions = [];
  const app = document.getElementById("app");

  function showWelcomeScreen() {
    app.innerHTML = `
      <h2 style="margin-bottom:.5rem">Welcome to Court Kings Trivia</h2>
      <p>Enter a username to begin.</p>
      <div style="display:flex;justify-content:center;gap:.5rem;margin-top:1rem;flex-wrap:wrap">
        <input type="text" id="usernameInput" placeholder="Enter username">
        <button onclick="startQuiz()">Start</button>
      </div>
      <div style="margin-top:1.2rem;">
        <button onclick="showLeaderboardOnly()">Check Leaderboard</button>
      </div>
    `;
  }

  function startQuiz() {
    username = document.getElementById("usernameInput").value.trim();
    if (!username) return alert("Please enter a username.");
    selectedQuestions = [...triviaQuestions].sort(() => 0.5 - Math.random()).slice(0, 6);
    score = 0; currentIndex = 0;
    showQuestion();
  }

  function showQuestion() {
    const current = selectedQuestions[currentIndex];
    const choices = generateChoices(current.answer);
    app.innerHTML = `
      <h3 style="margin-bottom:1rem">Q${currentIndex + 1}: ${current.question}</h3>
      ${choices.map(choice => `<button style="display:block;width:100%;margin:.4rem 0" onclick="handleAnswer('${choice}','${current.answer}')">${choice}</button>`).join('')}
      <div class="feedback" id="feedback"></div>
    `;
  }

  async function showLeaderboardOnly() {
    app.innerHTML = `
      <div class="leaderboard-container">
        <h3>🏆 Leaderboard</h3>
        <div id="leaderboard" class="leaderboard">Loading...</div>
      </div>
    `;
    loadLeaderboard();
  }

  function generateChoices(correct) {
    let set = new Set([correct]);
    while (set.size < 4) {
      let random = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)].answer;
      set.add(random);
    }
    return Array.from(set).sort(() => 0.5 - Math.random());
  }

  function handleAnswer(selected, correct) {
    const feedback = document.getElementById("feedback");
    const ok = (selected === correct);
    feedback.textContent = ok ? "✅ Correct!" : "❌ Incorrect.";
    feedback.style.color = ok ? "#4caf50" : "#ff5252";
    if (ok) score++;
    setTimeout(() => {
      currentIndex++;
      currentIndex < selectedQuestions.length ? showQuestion() : showFinalScore();
    }, 700);
  }

  async function showFinalScore() {
    app.innerHTML = `
      <h2 style="margin-bottom:.5rem">Trivia Complete!</h2>
      <p class="score-text">${username}, you scored ${score}/6.</p>
      <div class="leaderboard-container">
        <h3>🏆 Leaderboard</h3>
        <div id="leaderboard">Loading...</div>
      </div>
    `;

    fireBasketballConfetti();

    await supabase.from('triviakings').insert([{ username, score }]);
    loadLeaderboard();
  }

  async function loadLeaderboard() {
    const { data, error } = await supabase
      .from('triviakings')
      .select('*')
      .order('score', { ascending: false })
      .limit(10);

    const lb = document.getElementById("leaderboard");
    lb.innerHTML = error
      ? "Error loading leaderboard."
      : (data||[]).map((entry, i) =>
          `<div class="leaderboard-entry"><span>#${i + 1} — ${entry.username}</span><span>${entry.score}/6</span></div>`
        ).join('') || "<div>No scores yet. Be the first!</div>";
  }

  showWelcomeScreen();

  function fireBasketballConfetti() {
    const duration = 2000;
    const animationEnd = Date.now() + duration;
    const defaults = { spread: 120, startVelocity: 30, colors: ['#00ffc6','#c084fc','#ff5cf0','#afff5c'] };

    const interval = setInterval(function() {
      const timeLeft = animationEnd - Date.now();
      if (timeLeft <= 0) return clearInterval(interval);
      confetti(Object.assign({}, defaults, { particleCount: 40, origin: { y: 0 } }));
    }, 250);
  }

  // Mobile hamburger toggle (same behavior as index.html)
  const toggle = document.querySelector('.nav-toggle');
  const nav = document.getElementById('primary-nav');
  if (toggle && nav) {
    toggle.addEventListener('click', () => {
      const open = nav.classList.toggle('open');
      toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  }
  </script>
</body>
</html>
